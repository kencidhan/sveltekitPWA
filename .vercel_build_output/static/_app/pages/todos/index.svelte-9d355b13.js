import{S as ee,i as te,s as ne,e as T,k as x,c as q,a as O,n as D,d as E,b as a,F as z,f as G,G as v,T as S,U as Q,V as oe,W as ae,X as le,Y as se,Z as J,Q as ie,t as re,N as ue,g as de,_ as ce,w as fe,x as _e,u as he,$ as me,a0 as K,r as pe,a1 as ve,H as be}from"../../chunks/vendor-e8066c82.js";function V(d,{pending:t,error:e,result:l}){let u;async function m(f){const h=u={};f.preventDefault();const b=new FormData(d);t&&t(b,d);try{const s=await fetch(d.action,{method:d.method,headers:{accept:"application/json"},body:b});if(h!==u)return;s.ok?l(s,d):e?e(s,null,d):console.error(await s.text())}catch(s){if(e)e(null,s,d);else throw s}}return d.addEventListener("submit",m),{destroy(){d.removeEventListener("submit",m)}}}function P(d,t,e){const l=d.slice();return l[6]=t[e],l[7]=t,l[8]=e,l}function $(d,t){let e,l,u,m,f,h,b,s,n,_,c,w,k,y,M,i,r,o,j,I,U,C,F,H,L=be,N,A,W;function X(...g){return t[3](t[6],t[7],t[8],...g)}function Y(){return t[4](t[6])}return{key:d,first:null,c(){e=T("div"),l=T("form"),u=T("input"),f=x(),h=T("button"),_=x(),c=T("form"),w=T("input"),y=x(),M=T("button"),r=x(),o=T("form"),j=T("button"),C=x(),this.h()},l(g){e=q(g,"DIV",{class:!0});var p=O(e);l=q(p,"FORM",{action:!0,method:!0});var R=O(l);u=q(R,"INPUT",{type:!0,name:!0,value:!0,class:!0}),f=D(R),h=q(R,"BUTTON",{class:!0,"aria-label":!0}),O(h).forEach(E),R.forEach(E),_=D(p),c=q(p,"FORM",{class:!0,action:!0,method:!0});var B=O(c);w=q(B,"INPUT",{"aria-label":!0,type:!0,name:!0,value:!0,class:!0}),y=D(B),M=q(B,"BUTTON",{class:!0,"aria-label":!0}),O(M).forEach(E),B.forEach(E),r=D(p),o=q(p,"FORM",{action:!0,method:!0});var Z=O(o);j=q(Z,"BUTTON",{class:!0,"aria-label":!0}),O(j).forEach(E),Z.forEach(E),C=D(p),p.forEach(E),this.h()},h(){a(u,"type","hidden"),a(u,"name","done"),u.value=m=t[6].done?"":"true",a(u,"class","svelte-dmxqmd"),a(h,"class","toggle svelte-dmxqmd"),a(h,"aria-label",b="Mark todo as "+(t[6].done?"not done":"done")),a(l,"action",s="/todos/"+t[6].uid+".json?_method=patch"),a(l,"method","post"),a(w,"aria-label","Edit todo"),a(w,"type","text"),a(w,"name","text"),w.value=k=t[6].text,a(w,"class","svelte-dmxqmd"),a(M,"class","save svelte-dmxqmd"),a(M,"aria-label","Save todo"),a(c,"class","text svelte-dmxqmd"),a(c,"action",i="/todos/"+t[6].uid+".json?_method=patch"),a(c,"method","post"),a(j,"class","delete svelte-dmxqmd"),a(j,"aria-label","Delete todo"),a(o,"action",I="/todos/"+t[6].uid+".json?_method=delete"),a(o,"method","post"),a(e,"class","todo svelte-dmxqmd"),z(e,"done",t[6].done),this.first=e},m(g,p){G(g,e,p),v(e,l),v(l,u),v(l,f),v(l,h),v(e,_),v(e,c),v(c,w),v(c,y),v(c,M),v(e,r),v(e,o),v(o,j),v(e,C),N=!0,A||(W=[S(n=V.call(null,l,{pending:X,result:t[1]})),S(V.call(null,c,{result:t[1]})),S(U=V.call(null,o,{result:Y}))],A=!0)},p(g,p){t=g,(!N||p&1&&m!==(m=t[6].done?"":"true"))&&(u.value=m),(!N||p&1&&b!==(b="Mark todo as "+(t[6].done?"not done":"done")))&&a(h,"aria-label",b),(!N||p&1&&s!==(s="/todos/"+t[6].uid+".json?_method=patch"))&&a(l,"action",s),n&&Q(n.update)&&p&1&&n.update.call(null,{pending:X,result:t[1]}),(!N||p&1&&k!==(k=t[6].text)&&w.value!==k)&&(w.value=k),(!N||p&1&&i!==(i="/todos/"+t[6].uid+".json?_method=patch"))&&a(c,"action",i),(!N||p&1&&I!==(I="/todos/"+t[6].uid+".json?_method=delete"))&&a(o,"action",I),U&&Q(U.update)&&p&1&&U.update.call(null,{result:Y}),p&1&&z(e,"done",t[6].done)},r(){H=e.getBoundingClientRect()},f(){oe(e),L(),ae(e,H)},a(){L(),L=le(e,H,me,{duration:200})},i(g){N||(g&&se(()=>{F||(F=J(e,K,{start:.7},!0)),F.run(1)}),N=!0)},o(g){g&&(F||(F=J(e,K,{start:.7},!1)),F.run(0)),N=!1},d(g){g&&E(e),g&&F&&F.end(),A=!1,ie(W)}}}function we(d){let t,e,l,u,m,f,h,b,s,n=[],_=new Map,c,w,k,y=d[0];const M=i=>i[6].uid;for(let i=0;i<y.length;i+=1){let r=P(d,y,i),o=M(r);_.set(o,n[i]=$(o,r))}return{c(){t=x(),e=T("div"),l=T("h1"),u=re("Todos"),m=x(),f=T("form"),h=T("input"),s=x();for(let i=0;i<n.length;i+=1)n[i].c();this.h()},l(i){ue('[data-svelte="svelte-181o7gf"]',document.head).forEach(E),t=D(i),e=q(i,"DIV",{class:!0});var o=O(e);l=q(o,"H1",{});var j=O(l);u=de(j,"Todos"),j.forEach(E),m=D(o),f=q(o,"FORM",{class:!0,action:!0,method:!0});var I=O(f);h=q(I,"INPUT",{name:!0,"aria-label":!0,placeholder:!0,class:!0}),I.forEach(E),s=D(o);for(let U=0;U<n.length;U+=1)n[U].l(o);o.forEach(E),this.h()},h(){document.title="Todos",a(h,"name","text"),a(h,"aria-label","Add todo"),a(h,"placeholder","+ tap to add a todo"),a(h,"class","svelte-dmxqmd"),a(f,"class","new svelte-dmxqmd"),a(f,"action","/todos.json"),a(f,"method","post"),a(e,"class","todos svelte-dmxqmd")},m(i,r){G(i,t,r),G(i,e,r),v(e,l),v(l,u),v(e,m),v(e,f),v(f,h),v(e,s);for(let o=0;o<n.length;o+=1)n[o].m(e,null);c=!0,w||(k=S(b=V.call(null,f,{result:d[2]})),w=!0)},p(i,[r]){if(b&&Q(b.update)&&r&1&&b.update.call(null,{result:i[2]}),r&3){y=i[0],pe();for(let o=0;o<n.length;o+=1)n[o].r();n=ce(n,r,M,1,i,y,_,e,ve,$,null,P);for(let o=0;o<n.length;o+=1)n[o].a();fe()}},i(i){if(!c){for(let r=0;r<y.length;r+=1)_e(n[r]);c=!0}},o(i){for(let r=0;r<n.length;r+=1)he(n[r]);c=!1},d(i){i&&E(t),i&&E(e);for(let r=0;r<n.length;r+=1)n[r].d();w=!1,k()}}}var ke=function(d,t,e,l){function u(m){return m instanceof e?m:new e(function(f){f(m)})}return new(e||(e=Promise))(function(m,f){function h(n){try{s(l.next(n))}catch(_){f(_)}}function b(n){try{s(l.throw(n))}catch(_){f(_)}}function s(n){n.done?m(n.value):u(n.value).then(h,b)}s((l=l.apply(d,t||[])).next())})};const Ee=({fetch:d})=>ke(void 0,void 0,void 0,function*(){const t=yield d("/todos.json");if(t.ok)return{props:{todos:yield t.json()}};const{message:e}=yield t.json();return{error:new Error(e)}});function ye(d,t,e){var l=this&&this.__awaiter||function(s,n,_,c){function w(k){return k instanceof _?k:new _(function(y){y(k)})}return new(_||(_=Promise))(function(k,y){function M(o){try{r(c.next(o))}catch(j){y(j)}}function i(o){try{r(c.throw(o))}catch(j){y(j)}}function r(o){o.done?k(o.value):w(o.value).then(M,i)}r((c=c.apply(s,n||[])).next())})};let{todos:u}=t;function m(s){return l(this,void 0,void 0,function*(){const n=yield s.json();e(0,u=u.map(_=>_.uid===n.uid?n:_))})}const f=async(s,n)=>{const _=await s.json();e(0,u=[...u,_]),n.reset()},h=(s,n,_,c)=>{e(0,n[_].done=!!c.get("done"),u)},b=s=>{e(0,u=u.filter(n=>n.uid!==s.uid))};return d.$$set=s=>{"todos"in s&&e(0,u=s.todos)},[u,m,f,h,b]}class je extends ee{constructor(t){super();te(this,t,ye,we,ne,{todos:0})}}export{je as default,Ee as load};
